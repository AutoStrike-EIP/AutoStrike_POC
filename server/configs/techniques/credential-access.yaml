# Credential Access techniques - MITRE ATT&CK
# All techniques are safe/read-only (no credential dumping, just enumeration)

- id: "T1552.001"
  name: "Credentials In Files"
  description: "Adversaries may search local file systems and remote file shares for files containing credentials."
  tactic: "credential-access"
  platforms:
    - "windows"
    - "linux"
  executors:
    - type: "powershell"
      command: "Get-ChildItem -Path C:\\Users -Recurse -Include *.txt,*.xml,*.config -ErrorAction SilentlyContinue | Select-Object -First 10 FullName"
      platform: "windows"
      timeout: 120
    - type: "bash"
      command: "find /home -type f \\( -name '*.conf' -o -name '*.cfg' -o -name '*.ini' \\) 2>/dev/null | head -20"
      platform: "linux"
      timeout: 120
  detection:
    - source: "File System"
      indicator: "Unusual file access patterns in user directories"
    - source: "Process Creation"
      indicator: "Scripted file enumeration activity"
  is_safe: true

- id: "T1555.003"
  name: "Credentials from Web Browsers"
  description: "Adversaries may acquire credentials from web browsers by reading files specific to the target browser."
  tactic: "credential-access"
  platforms:
    - "windows"
    - "linux"
  executors:
    - type: "powershell"
      command: "Get-ChildItem -Path \"$env:LOCALAPPDATA\\Google\\Chrome\\User Data\\Default\" -ErrorAction SilentlyContinue | Select-Object Name"
      platform: "windows"
      timeout: 60
    - type: "bash"
      command: "ls -la ~/.config/google-chrome/Default 2>/dev/null || ls -la ~/.mozilla/firefox/*.default* 2>/dev/null | head -10"
      platform: "linux"
      timeout: 60
  detection:
    - source: "File System"
      indicator: "Access to browser profile directories"
    - source: "Process Creation"
      indicator: "Non-browser process accessing browser data files"
  is_safe: true

- id: "T1003.008"
  name: "/etc/passwd and /etc/shadow"
  description: "Adversaries may attempt to dump the contents of /etc/passwd and /etc/shadow to enable offline password cracking."
  tactic: "credential-access"
  platforms:
    - "linux"
  executors:
    - type: "bash"
      command: "cat /etc/passwd | head -10 && ls -la /etc/shadow"
      platform: "linux"
      timeout: 60
  detection:
    - source: "File Access"
      indicator: "Access to /etc/passwd or /etc/shadow"
    - source: "Process Creation"
      indicator: "cat or similar tool accessing credential files"
  is_safe: true

- id: "T1552.004"
  name: "Private Keys"
  description: "Adversaries may search for private key certificate files on compromised systems for insecurely stored credentials."
  tactic: "credential-access"
  platforms:
    - "windows"
    - "linux"
  executors:
    - type: "powershell"
      command: "Get-ChildItem -Path C:\\Users -Recurse -Include *.pem,*.ppk,*.key -ErrorAction SilentlyContinue | Select-Object -First 10 FullName"
      platform: "windows"
      timeout: 120
    - type: "bash"
      command: "find /home -type f \\( -name '*.pem' -o -name '*.key' -o -name 'id_rsa' -o -name 'id_ed25519' \\) 2>/dev/null | head -20"
      platform: "linux"
      timeout: 120
  detection:
    - source: "File System"
      indicator: "Access to SSH keys or certificate files"
    - source: "Process Creation"
      indicator: "Enumeration of private key files"
  is_safe: true
