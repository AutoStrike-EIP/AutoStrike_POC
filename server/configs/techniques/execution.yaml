- id: "T1059.001"
  name: "PowerShell"
  description: "Adversaries may abuse PowerShell commands and scripts for execution."
  tactic: "execution"
  platforms:
    - "windows"
  executors:
    - type: "powershell"
      command: "Get-Process | Select-Object -First 5"
      platform: "windows"
      timeout: 60
  detection:
    - source: "Process Creation"
      indicator: "powershell.exe execution with unusual arguments"
    - source: "Script Block Logging"
      indicator: "Suspicious PowerShell commands"
  is_safe: true

- id: "T1059.003"
  name: "Windows Command Shell"
  description: "Adversaries may abuse the Windows command shell for execution."
  tactic: "execution"
  platforms:
    - "windows"
  executors:
    - type: "cmd"
      command: "echo %USERNAME% && echo %COMPUTERNAME%"
      platform: "windows"
      timeout: 60
  detection:
    - source: "Process Creation"
      indicator: "cmd.exe execution with unusual arguments"
  is_safe: true

- id: "T1059.004"
  name: "Unix Shell"
  description: "Adversaries may abuse Unix shell commands and scripts for execution."
  tactic: "execution"
  platforms:
    - "linux"
  executors:
    - type: "bash"
      command: "echo $USER && hostname"
      platform: "linux"
      timeout: 60
    - type: "sh"
      command: "echo $USER && hostname"
      platform: "linux"
      timeout: 60
  detection:
    - source: "Process Creation"
      indicator: "bash or sh execution with unusual arguments"
  is_safe: true

- id: "T1047"
  name: "Windows Management Instrumentation"
  description: "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads."
  tactic: "execution"
  platforms:
    - "windows"
  executors:
    - type: "cmd"
      command: "wmic os get Caption,Version,BuildNumber,OSArchitecture /format:list"
      platform: "windows"
      timeout: 60
    - type: "powershell"
      command: "Get-WmiObject -Class Win32_OperatingSystem | Select-Object Caption,Version,BuildNumber,OSArchitecture; Get-WmiObject -Class Win32_Process | Select-Object -First 10 Name,ProcessId,CommandLine"
      platform: "windows"
      timeout: 60
  detection:
    - source: "Process Creation"
      indicator: "wmic.exe or WmiPrvSE.exe spawning child processes"
    - source: "Windows Event Log"
      indicator: "Event ID 5857/5861 - WMI activity"
  is_safe: true

- id: "T1059.006"
  name: "Python"
  description: "Adversaries may abuse Python commands and scripts for execution."
  tactic: "execution"
  platforms:
    - "windows"
    - "linux"
  executors:
    - type: "cmd"
      command: "where python 2>nul && python --version 2>nul || where python3 2>nul && python3 --version 2>nul || echo Python not found"
      platform: "windows"
      timeout: 60
    - type: "bash"
      command: "which python python3 2>/dev/null; python3 --version 2>/dev/null || python --version 2>/dev/null; pip3 list --format=columns 2>/dev/null | head -15 || echo 'pip not available'"
      platform: "linux"
      timeout: 60
  detection:
    - source: "Process Creation"
      indicator: "python.exe or python3 execution with suspicious arguments"
    - source: "Script Block Logging"
      indicator: "Python scripts with encoded or obfuscated content"
  is_safe: true
